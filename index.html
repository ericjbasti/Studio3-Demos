<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
    <title>Studio3</title>
	<meta name="viewport" content="width=device-width, user-scalable=0, maximum-scale=1"/>
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<link rel="apple-touch-icon" href="icon.png" />
</head>

<body style="margin:0;background: #333">
	<canvas id="canvas" height="600" width="800"  style="cursor:pointer;margin: 0 auto;display: block;outline:1px solid #BBFF00;"></canvas>
</body>
<script src="studio-compiled.js"></script>
<script src="stats.js"></script>
<script>
	
var stage = new Studio.Stage('canvas',{
	webgl : 1, 
	dur : 1000/60, 
	fullscreen : 0, 
	resolution : 1, 
	interpolate : 1, 
	_maxCount : 16333
})

var MAX = stage._maxCount/1 | 0
var gravity = .4

var ball = new Studio.Image('assets/char.png',{
	'head': {
		x : 0, 
		y : 0, 
		width : 12, 
		height : 10
	},
	'feet': {
		x : 0, 
		y : 10, 
		width : 12, 
		height : 11
	}
})


var BOXdrop = function(attr){
	this.image = ball
	this.slice = 'feet'
	this.color = new Studio.Color()

	if(attr){
		this.apply(attr)
	}
	this.color.set(Math.random()*510 ,Math.random()*510 ,Math.random()*510, 1)

	// this.color.set(255,255,255,1)
}

stage.onReady = function(){
	if(this.webgl) stage.setTexture(ball, 1)
}

Studio.extend(BOXdrop, Studio.Sprite)

BOXdrop.prototype.logic = function(){
	this.velocityY += gravity
	this.x += this.velocityX
	this.y += this.velocityY
	if(this.x > stage.width || this.x < 0){
		this.velocityX *= -1
	}
	if(!this.hit){
		this.y = this.y - stage.height;
		this.x = stage.width/2
		this.hit = 10
		this.velocityY = Math.random()*3
		this._snapback()
	}
	if(this.y>stage.height){
		this.velocityY *= -.8
		this.hit--
		this.y = stage.height-1
	}
}

for (var i = 0; i!=MAX;i++){
	var yy=new BOXdrop({
		x : stage.width/2 ,
		y : Math.random()*120,
		width : 24,
		height : 24,
		velocityX : 2-(Math.random()*4),
		velocityY : -10+(Math.random()*6),
		hit : 10
	});
	stage.addChild(yy)
}


stage.addEffect( STATS ,{
	external : true, 
	height : 50,
	width : stage.width,
	position : 0,
	clear_mode :'erase'
})

Studio.start()

</script>


</html>


