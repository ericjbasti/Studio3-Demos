<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
    <title>Studio3</title>
	<meta name="viewport" content="width=device-width, user-scalable=0, maximum-scale=1"/>
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<link rel="apple-touch-icon" href="icon.png" />
</head>

<body style="margin:0;background: #333">
	<canvas id="canvas" height="320" width="320"  style="cursor:pointer;margin: 0 auto;display: block;outline:1px solid #BBFF00;"></canvas>
</body>
<script src="studio-compiled.js"></script>
<script>
	
var stage = new Studio.Stage('canvas',{webgl:0, dur:1000/60, fullscreen:1})
stage.color.setFromHex("#FFCC00bb")
var butterflyWing = new Studio.Image('assets/butterfly-wing.png');
var butterflyWingRight = new Studio.Image('assets/butterfly-wing-right.png');
var butterflyBody = new Studio.Image('assets/butterfly-body.png');

var Butterfly = function(attr){
	this.image = butterflyBody;
	this.width = 20;
	this.height = 90;
	this.y = 200
	this._world = new Studio.DisplayProperty();
	this.scaleY = this.scaleX = .5 + (Math.random()*.15)
	if(attr){
		this.apply(attr);
	}
	this.leftWing = new Studio.ImageSlice({rect:{x:0, y:0, height: 200, width: 126}, image: butterflyWing, anchorX: 1, height: 200, width: 126, x: -5, y: -15});
	this.rightWing = new Studio.ImageSlice({rect:{x:0, y:0, height: 200, width: 126}, image: butterflyWingRight, anchorX: 0, height: 200, width: 126, x:5, y: -15});
	this.addChild(this.leftWing)
	this.addChild(this.rightWing)
	var count = Math.random()*22;
	this.speed = .7+ Math.random()
	this.boundsCheck = function(){
		if(this.x< -100){
			this.x = stage.width+100;
			this.rotation = 0;
		}
		if(this.y< -100){
			this.y = stage.height+100;
			this.speed = .7+ Math.random()
			this.rotation = 0;
		}
	}
	this.onEnterFrame = function(){
		var a = Math.cos(count);
		this.leftWing.scaleX = .66 - (a * .65);
		this.rightWing.scaleX = .66 - (a * .65);
		this.leftWing.scaleY = 1 + (a * .1);
		this.rightWing.scaleY = 1 + (a * .1);
		count+= .3 * this._world.speed;
		this.rotation += a;
		this.x += .5 -Math.random() * 2 * this._world.speed;
		this.y += .5 -Math.random() * 2 * this._world.speed;
		if(count > 12){
			count= 0;
			this.speed = .7+ Math.random();
		}
		this.boundsCheck();
	}
}

Butterfly.prototype = new Studio.Sprite();
Butterfly.constructor = Butterfly;


for (var i = 0; i != 30 ; i++){
	var a = new Butterfly({x: Math.random() * stage.width, y: Math.random() * stage.height});
	stage.addChild(a);
}
stage.onEnterFrame = function(){
	this.ctx.fillStyle="#000"
	this.ctx.fillText(Studio.delta.toFixed(0), 8, 16)
}
Studio.start();

</script>


</html>

